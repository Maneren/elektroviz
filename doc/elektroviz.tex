% LTeX: language=cs-CZ
\documentclass[12pt,a4paper]{paper}
\usepackage{a4wide}
\usepackage[margin=2.5cm]{geometry}
\usepackage[czech]{babel}
\usepackage{hyphsubst}
\usepackage{graphicx}
\usepackage{indentfirst}
\usepackage{microtype}
\usepackage{float}
\usepackage{amsmath}
\usepackage{esvect}

\selectlanguage{czech}
\PassOptionsToPackage{hyphens}{url}

\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,      
    urlcolor=blue,
    pdftitle={Elektroviz},
}
\urlstyle{same}

% define helper command for typesetting code
\newcommand{\code}[1]{\texttt{#1}}
\def\CC{{C\nolinebreak[4]\hspace{-.05em}\raisebox{.4ex}{\tiny\bf ++}}}

\chardef\_=`_

% increase spacing between table rows
\renewcommand{\arraystretch}{1.25}

\begin{document}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{pic/kiv-cmyk-cz}
\end{figure}

\begin{center}
	\vspace{.5cm}
	\LARGE{Elektroviz - Vizualizace elektrickÃ©ho pole}\\
	\large{SemestrÃ¡lnÃ­ prÃ¡ce - KIV/UPG 2024/25}
\end{center}

\vfill

\noindent
ZÃ¡padoÄeskÃ¡ univerzita v Plzni \hfill Pavel Altmann - A23B0264P\\
Katedra informatiky a vÃ½poÄetnÃ­ techniky \hfill 1. odevzdÃ¡nÃ­\\
StrÃ¡veno hodin: 95 \hfill \today
\thispagestyle{empty}

\newpage
\setcounter{page}{1}

\tableofcontents

\newpage

\section{ZadÃ¡nÃ­}

Ãškolem semestrÃ¡lnÃ­ prÃ¡ce je vytvoÅ™enÃ­ interaktivnÃ­ho programu pro vizualizaci
elektrostatickÃ©ho pole vytvoÅ™enÃ©ho bodovÃ½mi elektrickÃ½mi nÃ¡boji rozmÃ­stÄ›nÃ½ch v
prostoru.

Program bude moÅ¾nÃ© spustit z pÅ™Ã­kazovÃ© Å™Ã¡dky skriptem \code{./run.sh} s
volitelnÃ½m celoÄÃ­selnÃ½m parametrem urÄujÃ­cÃ­m scÃ©nÃ¡Å™ (viz nÃ­Å¾e) k vizualizaci.
Nebude-li parametr zadÃ¡n, bude zvolen scÃ©nÃ¡Å™ 0. Po spuÅ¡tÄ›nÃ­ programu se zobrazÃ­
okno o minimÃ¡lnÃ­ poÄÃ¡teÄnÃ­ velikosti 800x600px, ve kterÃ©m se zobrazÃ­ pÅ™ehlednÄ›
vÅ¡echny bodovÃ© nÃ¡boje zvolenÃ©ho scÃ©nÃ¡Å™e. VizuÃ¡lnÃ­ reprezentace nÃ¡boje (v
nejjednoduÅ¡Å¡Ã­ podobÄ› kruÅ¾nice s popiskem) musÃ­ bÃ½t volena tak, aby bylo moÅ¾nÃ©
jednoznaÄnÄ› urÄit velikost nÃ¡boje a jeho znamÃ©nko. V mÃ­stÄ› sondy bude zobrazen
Å¡ipkou vektor intenzity vektorovÃ©ho pole ğ¸âƒ— a opatÅ™en popiskem udÃ¡vajÃ­cÃ­ jeho
velikost $\|E\|$. VÅ¡echny elementy vizualizace (nÃ¡boje, popisky, Å¡ipky) musÃ­ bÃ½t
plnÄ› viditelnÃ©.

Intenzita vektorovÃ©ho pole v danÃ©m mÃ­stÄ› $\vec{x}$ se spoÄte
z Coulombova zÃ¡kona jako:
\[ \vec{E}(\vec{x}) = \frac{1}{4 \pi \epsilon_0}
\sum_i q_i \frac{\vv{x_i - x}}{\|\vv{x_i - x}\|^3} \]

Vizualizace se bude pravidelnÄ› (s Äasem) aktualizovat. JednotlivÃ© elementy
vizualizace budou automaticky svou velikost a rozmÃ­stÄ›nÃ­ pÅ™izpÅ¯sobovat velikosti
(a tvaru) okna tak, aby se prostor okna â€maximÃ¡lnÄ›â€œ vyuÅ¾il, ale zÃ¡roveÅˆ aby
nedoÅ¡lo ke zkreslenÃ­ souÅ™adnic.

ScÃ©nÃ¡Å™e:

\begin{itemize}
  \item ScÃ©nÃ¡Å™ 0 = pouze jeden bodovÃ½ nÃ¡boj +1C v poÄÃ¡tku souÅ™adnic (0, 0);
  \item ScÃ©nÃ¡Å™ 1 = jeden nÃ¡boj +1C v (-1, 0), druhÃ½ +1C v (1, 0);
  \item ScÃ©nÃ¡Å™ 2 = jeden nÃ¡boj -1C v (-1, 0), druhÃ½ +2C v (1, 0);
  \item ScÃ©nÃ¡Å™ 3 = ÄtyÅ™i nÃ¡boje: +1C v (-1, -1), +2C v (1, -1), -3C v (1, 1)
    a -4C v (-1, 1);
\end{itemize}

Ve vÅ¡ech tÄ›chto scÃ©nÃ¡Å™Ã­ch se sonda pohybuje po kruÅ¾nici se stÅ™edem v poÄÃ¡tku
souÅ™adnic (0, 0), polomÄ›rem 1 a Ãºhlovou rychlostÃ­ \( \frac{\pi}{6}
\frac{rad}{s} \).

\section{Implementace Å™eÅ¡enÃ­}

\subsection{PouÅ¾itÃ© technologie}

Vizualizace je naprogrogramovÃ¡na v jazyce \CC{} 23 s vyuÅ¾itÃ­m 2D grafickÃ©
knihovny \href{https://www.raylib.com/}{Raylib} verze 5.5.


\subsection{Architektura}

Program vyuÅ¾Ã­vÃ¡ OOP architekturu, kde kaÅ¾dÃ½ grafickÃ½ a logickÃ½ prvek je uzavÅ™enÃ½
do svÃ© tÅ™Ã­dy a zodpovÄ›dnÃ½ za veÅ¡kerÃ© vÃ½poÄty a kreslenÃ­, kterÃ© se ho tÃ½kajÃ­.
Funkce \code{main} mÃ¡ na starost pouze poÄÃ¡teÄnÃ­ nastavenÃ­ a nÃ¡slednÃ© pÅ™edÃ¡vÃ¡nÃ­
udÃ¡lostÃ­ (novÃ½ snÃ­mek, zmÄ›na velikosti okna, apod.) objektÅ¯m. NÄ›kterÃ© objekty
jako souÄÃ¡st obsahujÃ­ dalÅ¡Ã­ objekty a potom majÃ­ na starost jim udÃ¡losti
pÅ™edÃ¡vat.

\subsection{Objekty}

KaÅ¾dÃ½ objekt mÃ¡ pÅ™edevÅ¡Ã­m 2 metody \code{update} a \code{draw}. \code{update} je
zodpovÄ›dnÃ¡ za pÅ™epoÄÃ­tÃ¡nÃ­ vlastnostÃ­ objektu v zÃ¡vislosti na Äase, popÅ™. zmÄ›nÄ›
vlastnostÃ­ jinÃ½ch objektÅ¯ (napÅ™. sonda mÄ›nÃ­ polohu podle Äasu a namÄ›Å™enou
hodnotu podle sÃ­ly a polohy nÃ¡bojÅ¯).

KaÅ¾dÃ½ zde popsanÃ½ objekt se nachÃ¡zÃ­ ve svÃ©m vlastnÃ­m souboru.

\subsubsection{\code{Charge}}

Reprezentuje v simulaci jeden nÃ¡boj. 

Velikost nÃ¡boje mÅ¯Å¾e bÃ½t buÄ konstantnÃ­ nebo promÄ›nlivÃ¡ v Äase - reprezentovÃ¡no
tÅ™Ã­dami \code{StaticStrength} a \code{VariableStrength}. 

Vykresluje se jako kruh, jehoÅ¾ plocha (nikoliv prÅ¯mÄ›r) je pÅ™Ã­mo ÃºmÄ›rnÃ¡ velikosti
nÃ¡boje. DÃ¡le mÃ¡ bÃ­lÃ© ohraniÄenÃ­ a barvu vÃ½plnÄ› reprezentujÃ­cÃ­ velikost nÃ¡boje -
ÄervenÃ¡ 5 C a vÃ­ce, modrou 5 C a mÃ©nÄ› a lineÃ¡rnÃ­ interpolaci pÅ™es tmavÄ› Å¡edou
pro hodnoty mezi tÃ­m.

\subsubsection{\code{Probe}}

Reprezentuje v simulaci elektrickou sondu.

MÅ¯Å¾e bÃ½t buÄ statickÃ¡ nebo otÃ¡ÄivÄ› pohyblivÃ¡ - reprezentovÃ¡no tÅ™Ã­dami
\code{Static}, resp. \code{Rotating} ze jmennÃ©ho prostÅ™edÃ­ \code{position}.

Vykresluje se jako Å¡ipka reprezentujÃ­cÃ­ smÄ›r. DÃ©lka Å¡ipky je pro pÅ™ehlednost
pevnÄ› danÃ¡, protoÅ¾e pokusy s promÄ›nnou dÃ©lkou v zÃ¡vislosti na intenzitÄ› pole se
neosvÄ›dÄili. Intenzita se pohybuje v rozmezÃ­ nÄ›kolika Å™Ã¡dÅ¯ a velikost se tedy
pohybovala od sotva viditelnÃ© po vÃ­ce neÅ¾ 3 obrazovky dlouhÃ©.

ZÃ¡roveÅˆ mÅ¯Å¾e sonda volitelnÄ› zobrazovat text s numerickou velikostÃ­ intenzity ve
vÄ›deckÃ© notaci.

\subsubsection{\code{Grid}}

PÅ™edstavuje mÅ™Ã­Å¾ku na pozadÃ­, vÄetnÄ› sond v jejÃ­ch prÅ¯seÄÃ­cÃ­ch.

MÃ¡ nezÃ¡visle nastavitelnÃ© rozestupy mezi ÄÃ¡rami v obou smÄ›rech v pixelech - ve
vÃ½chozÃ­m nastavenÃ­ to je 50x50. Je dobrÃ© nenastavovat pÅ™Ã­liÅ¡ malÃ© rozestupy,
protoÅ¾e pak je jednak obraz nepÅ™ehlednÃ½ a druhak se velmi zvyÅ¡ujÃ­ nÃ¡roky na
vÃ½poÄetnÃ­ vÃ½kon grafickÃ© karty.

Pro zrychlenÃ­ kreslenÃ­ se potÅ™ebnÃ© souÅ™adnice Äar i sond poÄÃ­tajÃ­ pouze pÅ™i
inicializaci a zmÄ›nÄ› rozmÄ›rÅ¯ okna a jinak jsou uloÅ¾enÃ© v soukromÃ½ch atributech
tÅ™Ã­dy.

\subsection{OstatnÃ­ soubory}

\subsubsection{\code{field}}

JmennÃ© prostÅ™edÃ­ obsahuje funkce \code{E} a \code{potential}, poÄÃ­tajÃ­cÃ­ vektor
intezity, resp. skalÃ¡rnÃ­ potenciÃ¡l elektrickÃ©ho pole v zadanÃ©m bodÄ›.

\subsubsection{\code{utils}}

Obsahuje pomocnÃ© funkce pro interpolaci barev \code{lerpColor} a \code{lerpColor3},
funkci \code{sigmoid} pro poÄÃ­tÃ¡nÃ­ stejnojmennÃ© matematickÃ© funkce a funkci
\code{trim} pro odstranÄ›nÃ­ poÄÃ¡teÄnÃ­ch a koncovÃ½ch bÃ­lÃ½ch znakÅ¯ z Å™etÄ›zce.

\subsubsection{\code{BoundingRectangle}}

PomocnÃ¡ tÅ™Ã­da pro Å¡kÃ¡lovÃ¡nÃ­.

UmoÅ¾nuje snadnÃ© spoÄÃ­tÃ¡nÃ­ nejmenÅ¡Ã­ho obdÃ©lnÃ­ku, kterÃ½ obsahuje vÅ¡echny grafickÃ©
objekty. Na zÃ¡kladÄ› jeho rozmÄ›rÅ¯ se obraz Å¡kÃ¡luje, aby strany tohoto obdÃ©lnÃ­ku 
byly zhruba polovina okna.

\subsubsection{\code{MathEval}}

Sada funkcÃ­ pro vyhodnocovanÃ­ libovolnÃ½ch matematickÃ½ch vÃ½razÅ¯, vyuÅ¾Ã­vanÃ¡ pro
dynamicky nastavitelnÃ© vlastnosti. DalÅ¡Ã­ info patÅ™Ã­ do pozdÄ›jÅ¡Ã­ho odevzdanÃ­.

\subsection{Algoritmy}


\section{OvlÃ¡dÃ¡nÃ­ programu}

\subsection{SestavenÃ­}

Program je kompatibilnÃ­ s GNU/Linux systÃ©my s podporou grafickÃ©ho protokolu X11.

SestavenÃ­ se provÃ¡dÃ­ pomocÃ­ pÅ™iloÅ¾enÃ©ho \code{Makefile} pÅ™Ã­kazem \code{make
setup build}.

ProtoÅ¾e ale mnoho systÃ©mÅ¯ nemÃ¡ nainstalovanÃ© hlaviÄkovÃ© soubory pro knihovnu X11
(potÅ™ebnÃ© pro vÃ½voj vÄ›tÅ¡iny grafickÃ½ch aplikacÃ­), mÃ¡ zastaralÃ© verze pÅ™ekladaÄÅ¯,
apod. zvolil jsem pouÅ¾itÃ­ systÃ©mu Docker. SestavovacÃ­ skript \code{./build.sh}
vytvoÅ™Ã­ kontejner z pÅ™iloÅ¾enÃ©ho souboru \code{Dockerfile} a spustÃ­ ho. Ten 
spustÃ­ pÅ™iloÅ¾enÃ½ \code{Makefile}, kterÃ½ do sloÅ¾ky \code{vendor} stÃ¡hne knihovny
a vÅ¡e sestavÃ­ do sloÅ¾ky \code{build}. Skript pak jeÅ¡tÄ› pÅ™esune vÃ½slednÃ½
spustitelnÃ½ soubor do souboru \code{bin/elektroviz.new}.

\subsection{SpuÅ¡tÄ›nÃ­}

Program pÅ™ebÃ­rÃ¡ z pÅ™Ã­kazovÃ© Å™Ã¡dky parametr \code{scenario} a volitelnÄ›
\code{spacing}. \code{scenario} UrÄuje kterÃ½ scÃ©nÃ¡Å™ mÃ¡ bÃ½t spuÅ¡tÄ›n po zapnutÃ­
aplikace, pÅ™i absenci parametru se pouÅ¾ije scÃ©nÃ¡Å™ 0. \code{spacing} urÄuje
rozestupy mÅ™Ã­zky na pozadÃ­ ve formÃ¡tu \code{<width>x<height>}.

\textbf{DÅ¯leÅ¾itÃ©}: Program je nutnÃ© spustit ve stejnÃ© sloÅ¾ce, v jakÃ© se nechÃ¡zÃ­
sloÅ¾ka \code{scenarios}, jinak nebude schopnÃ½ naÄÃ­st Å¾adnÃ½ z vÃ½chozÃ­ch scÃ©nÃ¡Å™Å¯.
OriginÃ¡lnÄ› je v \code{src} ale \code{./build.sh} jÃ­ pro snadnÄ›jÅ¡Ã­ manipulaci
nakopÃ­ruje i do koÅ™enovÃ© sloÅ¾ky.

\section{Limitace}

Program pouze minimÃ¡lnÄ› oÅ¡etÅ™uje nesprÃ¡vnÃ© uÅ¾ivatelskÃ© vstupy a reaguje na nÄ›
vyjÃ­mkami, kterÃ© vÄ›tÅ¡inou zpÅ¯sobujÃ­ pÃ¡d aplikace. 

\end{document}
